<!doctype html>
<html lang="fr" data-color-scheme="auto">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  <meta name="theme-color" content="#0ea5e9">
  <title>Apprendre à jouer – Quatre en ligne</title>
  <meta name="description" content="Règles, conseils et démo interactive pour apprendre à jouer à Quatre en ligne.">
  <style>
    :root{
      --bg:#0b1220; --bg-soft:#111827; --fg:#e5e7eb; --fg-dim:#bcc1cd;
      --brand:#0ea5e9; --brand-2:#22d3ee; --ring:rgba(34,211,238,.35);
      --maxw:1000px; --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.25);
      --ease:cubic-bezier(.2,.7,.2,1);
      --cell:70; /* taille d’une case en px (sans unit en CSS vars pour JS) */
      --gap:10;  /* espace entre cases */
      --pad:14;  /* marge intérieure du plateau */
    }
    @media (prefers-color-scheme: light){
      :root{--bg:#f8fafc;--bg-soft:#ffffff;--fg:#0b1220;--fg-dim:#475569;--ring:rgba(14,165,233,.25)}
    }
    *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
    .container{max-width:var(--maxw);margin-inline:auto;padding:clamp(16px,2vw,24px)}
    header{position:sticky;top:0;background:rgba(17,24,39,.75);backdrop-filter:saturate(120%) blur(8px);z-index:40;border-bottom:1px solid rgba(255,255,255,.06)}
    header .wrap{display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:.7rem;font-weight:800}
    .brand a{display:flex;align-items:center;gap:.7rem;color:inherit}
    .logo{inline-size:36px;block-size:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand-2));display:grid;place-items:center;color:#fff;font-weight:900}
    nav ul{display:flex;gap:1rem;list-style:none;margin:0;padding:0}
    nav a{display:block;padding:.8rem .9rem;border-radius:10px}
    .card{background:var(--bg-soft);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.06)}
    h1{font-size:clamp(1.8rem,4vw,2.6rem);margin:.2rem 0 0}
    h2{font-size:clamp(1.3rem,3vw,1.8rem);margin:0 0 .2rem}
    .muted{color:var(--fg-dim)}
    .row{display:grid;gap:16px;grid-template-columns:repeat(12,1fr)}
    .row>*{grid-column:span 12}
    @media(min-width:760px){.row-2>*{grid-column:span 6}}

    .panel{padding:18px}
    .btn{display:inline-flex;align-items:center;gap:.5rem;background:linear-gradient(90deg,var(--brand),var(--brand-2));color:white;border:0;border-radius:999px;padding:.65rem 1rem;font-weight:700}
    .btn:focus{outline:3px solid var(--ring);outline-offset:3px}

    /* ====== Plateau interactif ====== */
    .playground{display:grid;gap:16px;align-items:start}
    .hud{display:flex;align-items:center;gap:.6rem;flex-wrap:wrap}
    .dot{width:12px;height:12px;border-radius:50%}
    .dot.red{background:#ef4444}
    .dot.yellow{background:#facc15}
    .board-wrap{display:grid;gap:10px}
    .board{
      position:relative; 
      --cellpx: calc(var(--cell) * 1px);
      --gappx:  calc(var(--gap) * 1px);
      --padpx:  calc(var(--pad) * 1px);
      width: calc(var(--padpx)*2 + var(--cellpx)*7 + var(--gappx)*6);
      height:calc(var(--padpx)*2 + var(--cellpx)*6 + var(--gappx)*5);
      border-radius:18px; background:linear-gradient(180deg,#1e293b,#0f172a);
      box-shadow: inset 0 8px 30px rgba(0,0,0,.35), 0 10px 30px rgba(0,0,0,.3);
      overflow:hidden;
    }
    /* Grille (trous) */
    .holes{position:absolute; inset:var(--padpx); display:grid;
      grid-template-columns:repeat(7, var(--cellpx));
      grid-template-rows:repeat(6, var(--cellpx));
      gap:var(--gappx); pointer-events:none; 
    }
    .hole{border-radius:50%; background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,.08), rgba(0,0,0,.35) 70%);
      box-shadow: inset 0 6px 16px rgba(0,0,0,.5);
    }
    /* Couche des pions */
    .tokens{position:absolute; inset:0}
    .token{
      position:absolute; width:var(--cellpx); height:var(--cellpx); border-radius:50%;
      box-shadow: inset 0 10px 18px rgba(255,255,255,.2), inset 0 -14px 18px rgba(0,0,0,.45), 0 6px 18px rgba(0,0,0,.35);
      transform:translateY(-120%); /* start au-dessus */
      transition:transform .5s var(--ease), filter .2s var(--ease);
      will-change:transform;
    }
    .token.red{ background:radial-gradient(circle at 35% 35%, #fecaca, #ef4444 60%) }
    .token.yellow{ background:radial-gradient(circle at 35% 35%, #fde68a, #facc15 60%) }
    .token.win{outline:4px solid #22c55e; filter:drop-shadow(0 0 10px rgba(34,197,94,.6))}
    .board.clickable{cursor:crosshair}
    .legend{font-size:.9rem;color:var(--fg-dim)}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, monospace; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); padding:.15rem .35rem; border-radius:6px}

    footer{padding-block:40px;border-top:1px solid rgba(255,255,255,.08);color:var(--fg-dim)}
  </style>
</head>
<body>
  <a class="sr-only" href="#contenu">Aller au contenu</a>
  <header>
    <div class="container wrap">
      <div class="brand" aria-label="Accueil">
        <a href="index.html">
          <div class="logo" aria-hidden="true">★</div>
          <span>Quatre en ligne</span>
        </a>
      </div>
      <nav aria-label="Navigation principale">
        <ul>
          <li><a href="index.html">Accueil</a></li>
          <li><a aria-current="page">Apprendre à jouer</a></li>
          <li><a href="#regles">Règles</a></li>
          <li><a href="#conseils">Conseils</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="contenu" class="container">
    <section class="row">
      <div class="card panel" style="grid-column:span 12">
        <h1>Apprendre à jouer</h1>
        <p class="muted">Alignez 4 pions de votre couleur horizontalement, verticalement ou en diagonale avant votre adversaire.</p>
      </div>
    </section>

    <section class="row row-2">
      <div class="card panel">
        <h2 id="regles">Règles rapides</h2>
        <ol>
          <li>Chaque joueur joue à tour de rôle et <strong>lâche un pion</strong> dans l’une des 7 colonnes.</li>
          <li>Le pion tombe jusqu’à la <strong>première case libre</strong> de la colonne.</li>
          <li>Gagnez en alignant <strong>4 pions</strong> de votre couleur (horizontale, verticale, ou diagonale).</li>
          <li>Si la grille est pleine sans alignement, c’est <strong>match nul</strong>.</li>
        </ol>
      </div>

      <div class="card panel playground">
        <h2>Démo interactive</h2>
        <div class="hud">
          <span>Tour :</span>
          <span class="dot red" id="turnDot" aria-hidden="true"></span>
          <strong id="turnLabel">Rouge</strong>
          <span class="legend">Clique une colonne pour lâcher un pion. <span class="kbd">R</span> pour réinitialiser.</span>
        </div>
        <div class="board-wrap">
          <div class="board clickable" id="board" role="application" aria-label="Plateau 7 colonnes sur 6 rangées">
            <div class="tokens" id="tokens"></div>
            <div class="holes" aria-hidden="true">
              <!-- 6 x 7 trous -->
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
              <div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div><div class="hole"></div>
            </div>
          </div>
          <div>
            <button class="btn" id="resetBtn">Réinitialiser</button>
          </div>
        </div>
      </div>
    </section>

    <section class="row">
      <div class="card panel">
        <h2 id="conseils">Conseils & petites stratégies</h2>
        <ul>
          <li><strong>Priorise la colonne centrale</strong> : elle crée le plus d’opportunités d’alignement.</li>
          <li><strong>Bloque les “3 alignés”</strong> de l’adversaire dès que possible.</li>
          <li><strong>Prépare des fourches</strong> (deux menaces simultanées) : difficile à contrer en un seul coup.</li>
          <li><strong>Évite de donner une victoire verticale</strong> en jouant sous un “3 vertical” adverse.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="container center">
    <small>© <span id="year"></span> Quatre en ligne • <a href="index.html">Accueil</a></small>
  </footer>

  <script>
    // Année
    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== Démo Connect 4 (simple) ======
    const ROWS = 6, COLS = 7;
    const boardEl = document.getElementById('board');
    const tokensEl = document.getElementById('tokens');
    const turnDot = document.getElementById('turnDot');
    const turnLabel = document.getElementById('turnLabel');
    const resetBtn = document.getElementById('resetBtn');

    let grid, player, gameOver;

    function init(){
      grid = Array.from({length:ROWS}, ()=> Array(COLS).fill(0)); // 0=vide,1=rouge,2=jaune
      player = 1; gameOver = false;
      tokensEl.innerHTML = '';
      turnDot.className = 'dot red';
      turnLabel.textContent = 'Rouge';
      boardEl.classList.add('clickable');
    }
    init();

    function cssNumber(name){
      return parseInt(getComputedStyle(boardEl).getPropertyValue(name));
    }
    const pad = cssNumber('--padpx') || 14;
    const gap = cssNumber('--gappx') || 10;
    const cell = cssNumber('--cellpx') || 70;

    function colFromEvent(e){
      const r = boardEl.getBoundingClientRect();
      const x = e.clientX - r.left - pad;
      if (x < 0) return 0;
      const pitch = cell + gap;
      return Math.min(COLS-1, Math.max(0, Math.floor(x / pitch)));
    }

    function nextEmptyRow(c){
      for(let r=ROWS-1; r>=0; r--) if(grid[r][c]===0) return r;
      return -1;
    }

    function dropToken(c){
      if (gameOver) return;
      const r = nextEmptyRow(c);
      if (r < 0) return;
      grid[r][c] = player;
      const token = document.createElement('div');
      token.className = 'token ' + (player===1?'red':'yellow');
      token.style.left = (pad + c*(cell+gap)) + 'px';
      token.style.top  = (-cell) + 'px'; // start au-dessus
      tokensEl.appendChild(token);
      // Forcer layout puis animer vers la position finale
      requestAnimationFrame(()=>{
        token.style.transform = `translateY(${pad + r*(cell+gap) + cell}px)`; // +cell car top = -cell
      });

      const win = checkWin(r,c,player);
      if (win){
        highlightWin(win);
        end(`Le joueur ${player===1?'Rouge':'Jaune'} gagne !`);
        return;
      }
      if (grid.every(row=>row.every(v=>v!==0))){
        end('Match nul !');
        return;
      }
      // Tour suivant
      player = 3 - player; // alterne 1 <-> 2
      turnDot.className = 'dot ' + (player===1?'red':'yellow');
      turnLabel.textContent = (player===1?'Rouge':'Jaune');
    }

    function end(msg){
      gameOver = true;
      boardEl.classList.remove('clickable');
      turnLabel.textContent = msg;
    }

    function highlightWin(coords){
      // coords: tableau de [r,c]
      coords.forEach(([r,c])=>{
        const left = (pad + c*(cell+gap)) + 'px';
        const top  = (pad + r*(cell+gap)) + 'px';
        // trouver le token à cette position (le plus proche)
        const t = Array.from(tokensEl.children).find(el => el.style.left===left && el.style.transform===`translateY(${parseInt(top)+cell}px)`);
        if (t) t.classList.add('win');
      });
    }

    function countDir(r,c,dr,dc,who){
      let n=0, coords=[];
      let rr=r, cc=c;
      while(rr>=0 && rr<ROWS && cc>=0 && cc<COLS && grid[rr][cc]===who){
        n++; coords.push([rr,cc]); rr+=dr; cc+=dc;
      }
      return {n,coords};
    }

    function checkWin(r,c,who){
      // 4 directions: horiz, vert, diag1, diag2
      const dirs = [[0,1],[1,0],[1,1],[1,-1]];
      for(const [dr,dc] of dirs){
        const a = countDir(r,c, dr,dc, who);
        const b = countDir(r,c,-dr,-dc, who);
        const total = a.n + b.n - 1;
        if (total >= 4){
          // fusionne coords (en retirant doublon au centre)
          const coords = [...b.coords.reverse().slice(0,-1), ...a.coords];
          return coords.slice(0, total); // renvoie pour surlignage
        }
      }
      return null;
    }

    // Interactions
    boardEl.addEventListener('click', e=> dropToken(colFromEvent(e)));
    addEventListener('keydown', e=>{
      if (e.key.toLowerCase()==='r') { init(); }
    });
    resetBtn.addEventListener('click', init);
  </script>
</body>
</html>
